<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Dashboard Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* === CSS STYLES === */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

        :root {
            --primary-blue: #3c8dbc;
            --primary-dark: #367fa9;
            --sidebar-bg: #222d32;
            --sidebar-hover: #1e282c;
            --bg-gray: #ecf0f5;
            --text-dark: #333;
            --success: #00a65a;
            --danger: #dd4b39;
            --gold: #f39c12;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; }
        body { background-color: var(--bg-gray); height: 100vh; overflow-x: hidden; }

        /* Utilities */
        .hidden { display: none !important; }
        .success { color: var(--success); font-weight: bold; }
        .danger { color: var(--danger); font-weight: bold; }

        /* Login Screen */
        .auth-container {
            height: 100vh; display: flex; align-items: center; justify-content: center;
            background: var(--bg-gray); width: 100%;
        }
        .login-card {
            background: white; padding: 40px; border-top: 3px solid var(--primary-blue);
            width: 360px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.12);
        }
        .login-header { color: var(--primary-blue); margin-bottom: 20px; }
        .input-group {
            display: flex; align-items: center; border: 1px solid #ccc;
            margin-bottom: 15px; padding: 10px; background: white;
        }
        .input-group input { border: none; outline: none; margin-left: 10px; width: 100%; }
        .btn-primary {
            width: 100%; background: var(--primary-blue); color: white; border: none;
            padding: 12px; cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        .btn-primary:hover { background: var(--primary-dark); }

        /* Dashboard Layout */
        .dashboard-wrapper { display: flex; height: 100vh; width: 100%; }
        
        .sidebar {
            width: 230px; background: var(--sidebar-bg); color: #b8c7ce;
            display: flex; flex-direction: column; flex-shrink: 0;
        }
        .brand {
            height: 50px; background: var(--primary-dark); color: white;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; font-weight: bold;
        }
        .nav-links { list-style: none; display: flex; flex-direction: column; height: 100%; }
        .nav-links li a {
            display: block; padding: 12px 15px; color: #b8c7ce; text-decoration: none;
            border-left: 3px solid transparent;
        }
        .nav-links li:hover, .nav-links li.active { background: var(--sidebar-hover); color: white; }
        .nav-links li.active { border-left-color: var(--primary-blue); }
        .nav-links i { margin-right: 10px; width: 20px; text-align: center; }

        .main-content { flex: 1; display: flex; flex-direction: column; overflow-y: auto; }

        .top-bar {
            height: 50px; background: var(--primary-blue); color: white;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px;
        }
        .user-profile { display: flex; align-items: center; gap: 10px; cursor: pointer; }

        .content-container { padding: 15px; max-width: 1200px; margin: 0 auto; width: 100%; }

        /* Cards */
        .card {
            background: white; border-top: 3px solid #d2d6de;
            border-radius: 3px; box-shadow: 0 1px 1px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .card-header { padding: 10px; display: flex; justify-content: space-between; align-items: center; }
        .card-header h4 { font-size: 1rem; color: #444; font-weight: 500; }
        .border-bottom { border-bottom: 1px solid #f4f4f4; }

        .welcome-card { display: flex; padding: 20px; align-items: center; border-top-color: white; }
        .icon-circle {
            width: 60px; height: 60px; border-radius: 50%; border: 2px solid #ccc;
            display: flex; align-items: center; justify-content: center;
            font-size: 30px; color: #777; margin-right: 20px;
        }

        .grid-layout { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
        @media (max-width: 768px) { .grid-layout { grid-template-columns: 1fr; } .sidebar { display: none; } }

        /* Net Worth */
        .amount-large { font-size: 1.5rem; }
        .balance-list { padding: 10px 20px; }
        .balance-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f4f4f4; font-size: 0.9rem; }
        .total-row { border-top: 2px solid #eee; border-bottom: none; font-weight: bold; margin-top: 10px; padding-top: 10px; }

        /* Transaction Widget */
        .tabs { display: flex; border-bottom: 1px solid #f4f4f4; }
        .tab-btn {
            flex: 1; padding: 10px; background: transparent; border: none;
            border-bottom: 3px solid transparent; cursor: pointer; color: #444;
        }
        .tab-btn.active { border-bottom-color: var(--primary-blue); font-weight: bold; color: var(--text-dark); }
        .widget-form { padding: 20px; }
        .form-row { margin-bottom: 15px; }
        .form-row label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.85rem; }
        .form-row input, .form-row select { width: 100%; padding: 8px; border: 1px solid #d2d6de; }
        .btn-action { background: #3c8dbc; color: white; border: none; padding: 10px 20px; font-size: 0.9rem; cursor: pointer; float: right; }
        
        /* Table */
        .data-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        .data-table th, .data-table td { padding: 10px; text-align: left; border-bottom: 1px solid #f4f4f4; }
        .data-table th { background: white; font-weight: bold; color: #444; }
        .btn-delete { background: none; border: none; color: #999; cursor: pointer; }
        .btn-delete:hover { color: var(--danger); }

        /* Challenge & Gamification */
        .challenge-card { border-top: 3px solid var(--gold); }
        .progress-container {
            width: 100%; background-color: #e0e0e0; border-radius: 20px;
            height: 25px; overflow: hidden; margin-bottom: 15px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }
        .progress-bar {
            height: 100%; width: 0%; background: linear-gradient(90deg, #f1c40f, #f39c12);
            color: white; text-align: center; line-height: 25px;
            font-size: 0.8rem; font-weight: bold; transition: width 0.5s ease-in-out;
        }
        .reward-box {
            text-align: center; background: #fff8e1; padding: 15px;
            border: 1px dashed var(--gold); border-radius: 10px; animation: popIn 0.5s ease;
        }
        .btn-claim { background: var(--gold); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 5px; }
        .gold-badge { color: #f1c40f !important; text-shadow: 0 1px 2px rgba(0,0,0,0.3); }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <section id="authView" class="auth-container">
        <div class="login-card">
            <div class="login-header">
                <i class="fas fa-chart-pie fa-2x"></i>
                <h2>FinanceManager</h2>
            </div>
            <p>Sign in to manage your finances</p>
            
            <form id="loginForm">
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="loginUser" placeholder="Username (e.g. Admin)" required>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="loginPass" placeholder="Password" required>
                </div>
                <button type="submit" class="btn-primary">Sign In</button>
            </form>
            <p style="margin-top:20px; color:#777; font-size:0.8rem;">EEC 3733 Assignment Demo</p>
        </div>
    </section>

    <div id="dashboardView" class="dashboard-wrapper hidden">
        <nav class="sidebar">
            <div class="brand"><i class="fas fa-dollar-sign"></i> Finance</div>
            <ul class="nav-links">
                <li class="active"><a href="#"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="#"><i class="fas fa-exchange-alt"></i> Transactions</a></li>
                <li><a href="#"><i class="fas fa-wallet"></i> Accounts</a></li>
                <li><a href="#"><i class="fas fa-piggy-bank"></i> Budget</a></li>
                <li style="margin-top: auto;"><a href="#" onclick="app.logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </nav>

        <main class="main-content">
            <header class="top-bar">
                <h2 id="pageTitle">Dashboard</h2>
                <div class="user-profile">
                    <span id="displayUsername">User</span>
                    <i class="fas fa-user-circle fa-2x"></i>
                </div>
            </header>

            <div class="content-container">
                <div class="card welcome-card">
                    <div class="icon-circle"><i class="fas fa-user"></i></div>
                    <div>
                        <h3>Welcome to your account!</h3>
                        <p>This dashboard gives you an overview of your financial health. Data is stored locally.</p>
                    </div>
                </div>

                <div class="grid-layout">
                    <div class="col-left">
                        <div class="card net-worth-card">
                            <div class="card-header">
                                <h4><i class="fas fa-caret-down"></i> NET WORTH</h4>
                                <span class="amount-large success" id="netWorthDisplay">$0.00</span>
                            </div>
                            <div class="balance-list">
                                <div class="balance-item"><span>Cash / Wallet</span><span class="success" id="cashDisplay">$0.00</span></div>
                                <div class="balance-item"><span>Bank Account</span><span class="success" id="bankDisplay">$0.00</span></div>
                                <div class="balance-item total-row"><span>Total Assets</span><span class="success" id="totalAssetsDisplay">$0.00</span></div>
                            </div>
                        </div>

                        <div class="card challenge-card">
                            <div class="card-header"><h4><i class="fas fa-trophy"></i> BONUS CHALLENGE</h4></div>
                            <div style="padding: 20px;">
                                <p style="margin-bottom: 10px; color: #555;">Task: Reach a Net Worth of <strong>$2,000</strong></p>
                                <div class="progress-container"><div class="progress-bar" id="progressBar">0%</div></div>
                                <div id="rewardSection" class="reward-box hidden">
                                    <i class="fas fa-medal fa-3x" style="color: gold; margin-bottom: 10px;"></i>
                                    <h3>Target Smashed!</h3>
                                    <p>You've unlocked the <strong>Gold Pro Status</strong>.</p>
                                    <button class="btn-claim" onclick="app.claimReward()">Claim Reward</button>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header"><h4>Expenses by Category</h4></div>
                            <div style="height: 200px; padding: 10px;"><canvas id="expenseChart"></canvas></div>
                        </div>
                    </div>

                    <div class="col-right">
                        <div class="card transaction-widget">
                            <div class="card-header border-bottom"><h4><i class="fas fa-caret-down"></i> NEW TRANSACTION</h4></div>
                            <div class="tabs">
                                <button class="tab-btn active" onclick="app.setTab('expense', this)">Expense</button>
                                <button class="tab-btn" onclick="app.setTab('income', this)">Income</button>
                            </div>
                            <form id="addForm" class="widget-form">
                                <input type="hidden" id="transType" value="expense">
                                <div class="form-row"><label>Description</label><input type="text" id="desc" placeholder="e.g. Salary" required></div>
                                <div class="form-row"><label>Amount ($)</label><input type="number" id="amount" placeholder="0.00" step="0.01" required></div>
                                <div class="form-row">
                                    <label>Category</label>
                                    <select id="category">
                                        <option value="Food">Food</option>
                                        <option value="Transport">Transport</option>
                                        <option value="Shopping">Shopping</option>
                                        <option value="Housing">Housing</option>
                                        <option value="Salary">Salary</option>
                                    </select>
                                </div>
                                <div class="form-row"><label>Date</label><input type="date" id="date" required></div>
                                <button type="submit" class="btn-action">Add Expense</button>
                            </form>
                        </div>

                        <div class="card">
                            <div class="card-header border-bottom"><h4>RECENT TRANSACTIONS</h4></div>
                            <table class="data-table">
                                <thead><tr><th>Date</th><th>Description</th><th>Amount</th><th>Action</th></tr></thead>
                                <tbody id="transactionTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        class DashboardApp {
            constructor() {
                this.currentUser = sessionStorage.getItem('currentUser');
                this.transactions = JSON.parse(localStorage.getItem('transactions')) || [];
                this.chart = null;
                if(document.getElementById('date')) document.getElementById('date').valueAsDate = new Date();
                this.init();
            }

            init() {
                if (this.currentUser) this.switchView('dashboard');
                else this.switchView('auth');

                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const user = document.getElementById('loginUser').value;
                    if(user) {
                        sessionStorage.setItem('currentUser', user);
                        this.currentUser = user;
                        this.switchView('dashboard');
                    }
                });

                document.getElementById('addForm').addEventListener('submit', (e) => this.handleAddTransaction(e));
            }

            logout() {
                sessionStorage.removeItem('currentUser');
                this.currentUser = null;
                this.switchView('auth');
            }

            switchView(viewName) {
                const auth = document.getElementById('authView');
                const dash = document.getElementById('dashboardView');
                if(viewName === 'dashboard') {
                    auth.classList.add('hidden');
                    dash.classList.remove('hidden');
                    this.renderDashboard();
                } else {
                    dash.classList.add('hidden');
                    auth.classList.remove('hidden');
                }
            }

            handleAddTransaction(e) {
                e.preventDefault();
                const desc = document.getElementById('desc').value;
                const amount = document.getElementById('amount').value;
                const category = document.getElementById('category').value;
                const date = document.getElementById('date').value;
                const type = document.getElementById('transType').value;

                const newT = { id: Date.now(), desc, amount: parseFloat(amount), type, category, date };
                this.transactions.unshift(newT);
                localStorage.setItem('transactions', JSON.stringify(this.transactions));
                this.renderDashboard();
                e.target.reset();
                document.getElementById('date').valueAsDate = new Date();
            }

            deleteTransaction(id) {
                if(confirm('Delete this transaction?')) {
                    this.transactions = this.transactions.filter(t => t.id !== id);
                    localStorage.setItem('transactions', JSON.stringify(this.transactions));
                    this.renderDashboard();
                }
            }

            setTab(type, btn) {
                document.getElementById('transType').value = type;
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                const submitBtn = document.querySelector('.btn-action');
                if(type === 'income') { submitBtn.style.background = '#00a65a'; submitBtn.innerText = 'Add Income'; }
                else { submitBtn.style.background = '#3c8dbc'; submitBtn.innerText = 'Add Expense'; }
            }

            // Gamification Logic
            updateChallenge(netWorth) {
                const goal = 2000;
                let percent = Math.floor((netWorth / goal) * 100);
                if (percent < 0) percent = 0; if (percent > 100) percent = 100;

                const bar = document.getElementById('progressBar');
                bar.style.width = percent + '%';
                bar.innerText = percent + '%';

                const rewardBox = document.getElementById('rewardSection');
                if (netWorth >= goal) {
                    if(!localStorage.getItem('rewardClaimed')) rewardBox.classList.remove('hidden');
                    else this.applyGoldStatus();
                } else {
                    rewardBox.classList.add('hidden');
                }
            }

            claimReward() {
                localStorage.setItem('rewardClaimed', 'true');
                document.getElementById('rewardSection').classList.add('hidden');
                alert("ðŸŽ‰ Congratulations! You are now a Gold Pro User!");
                this.applyGoldStatus();
            }

            applyGoldStatus() {
                const profileIcon = document.querySelector('.user-profile i');
                profileIcon.classList.remove('fa-user-circle');
                profileIcon.classList.add('fa-crown', 'gold-badge'); 
                const userSpan = document.getElementById('displayUsername');
                if(!userSpan.innerHTML.includes('PRO')) userSpan.innerHTML += ' <span style="background:gold; color:black; font-size:10px; padding:2px 5px; border-radius:3px;">PRO</span>';
            }

            renderDashboard() {
                document.getElementById('displayUsername').innerText = this.currentUser;
                if(localStorage.getItem('rewardClaimed') === 'true') this.applyGoldStatus();

                let income = 0, expense = 0, catData = {};
                const tbody = document.getElementById('transactionTableBody');
                tbody.innerHTML = '';

                this.transactions.forEach(t => {
                    if(t.type === 'income') income += t.amount;
                    else { expense += t.amount; catData[t.category] = (catData[t.category] || 0) + t.amount; }
                    
                    const row = `<tr><td>${t.date}</td><td><span style="font-weight:500">${t.desc}</span><br><small style="color:#777">${t.category}</small></td><td class="${t.type === 'income' ? 'success' : 'danger'}">${t.type === 'income' ? '+' : '-'} $${t.amount.toFixed(2)}</td><td><button class="btn-delete" onclick="app.deleteTransaction(${t.id})"><i class="fas fa-trash"></i></button></td></tr>`;
                    tbody.innerHTML += row;
                });

                const netWorth = income - expense;
                document.getElementById('netWorthDisplay').innerText = `$${netWorth.toLocaleString()}`;
                document.getElementById('netWorthDisplay').className = netWorth >= 0 ? 'amount-large success' : 'amount-large danger';
                document.getElementById('bankDisplay').innerText = `$${(netWorth * 0.7).toLocaleString()}`;
                document.getElementById('cashDisplay').innerText = `$${(netWorth * 0.3).toLocaleString()}`;
                document.getElementById('totalAssetsDisplay').innerText = `$${netWorth.toLocaleString()}`;

                this.updateChallenge(netWorth);

                const ctx = document.getElementById('expenseChart').getContext('2d');
                if(this.chart) this.chart.destroy();
                this.chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: { labels: Object.keys(catData), datasets: [{ data: Object.values(catData), backgroundColor: ['#f56954', '#00a65a', '#f39c12', '#00c0ef', '#3c8dbc'], borderWidth: 1 }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' } } }
                });
            }
        }
        const app = new DashboardApp();
    </script>
</body>
</html>
